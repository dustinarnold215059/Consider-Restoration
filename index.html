<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consider Restoration - Christopher Rembisz, LMT | Pain Relief & Body Restoration</title>
    <meta name="description" content="Professional massage therapy in Livonia, MI. Specializing in pain management, applied neurology, and therapeutic bodywork. Book your session today.">
    <meta name="keywords" content="massage therapy, pain relief, Livonia MI, applied neurology, therapeutic bodywork, Christopher Rembisz">
    <meta name="author" content="Christopher Rembisz, LMT">
    <meta property="og:title" content="Consider Restoration - Christopher Rembisz, LMT">
    <meta property="og:description" content="Because Pain Shouldn't Be Your Normal. Professional massage therapy and body restoration in Livonia, MI.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://considerrestoration.com">
    <!-- Temporarily disabled for testing -->
    <!-- <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/image-placeholders.css">
    
    <!-- Google Analytics - Temporarily disabled for testing -->
    <!--
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-XXXXXXXXXX', {
            page_title: 'Home - Consider Restoration',
            page_location: window.location.href
        });
        
        // Track booking button clicks
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('a[href*="booking"]').forEach(link => {
                link.addEventListener('click', function() {
                    gtag('event', 'click', {
                        event_category: 'Booking',
                        event_label: 'Book Appointment CTA',
                        value: 1
                    });
                });
            });
        });
    </script>
    -->
    
    <script src="js/error-handler.js" defer></script>
    <!-- <script src="js/security-enhanced.js" defer></script> -->
    <script src="js/lazy-loading.js" defer></script>
    <script src="js/shared-data.js" defer></script>
    
    <!-- Local Business Schema Markup -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "LocalBusiness",
        "@id": "https://considerrestoration.com",
        "name": "Consider Restoration",
        "alternateName": "Consider Restoration Massage Therapy",
        "description": "Professional massage therapy and bodywork services specializing in pain management, applied neurology, and therapeutic treatments in Livonia, MI.",
        "url": "https://considerrestoration.com",
        "telephone": "(734) 419-4116",
        "email": "info@considerrestoration.com",
        "address": {
            "@type": "PostalAddress",
            "streetAddress": "Livonia",
            "addressLocality": "Livonia",
            "addressRegion": "MI",
            "addressCountry": "US"
        },
        "geo": {
            "@type": "GeoCoordinates",
            "latitude": "42.3684",
            "longitude": "-83.3532"
        },
        "areaServed": [
            {
                "@type": "City",
                "name": "Livonia",
                "containedInPlace": {
                    "@type": "State",
                    "name": "Michigan"
                }
            },
            {
                "@type": "City",
                "name": "Plymouth",
                "containedInPlace": {
                    "@type": "State", 
                    "name": "Michigan"
                }
            },
            {
                "@type": "City",
                "name": "Canton",
                "containedInPlace": {
                    "@type": "State",
                    "name": "Michigan"
                }
            },
            {
                "@type": "City",
                "name": "Westland",
                "containedInPlace": {
                    "@type": "State",
                    "name": "Michigan"
                }
            },
            {
                "@type": "City",
                "name": "Farmington Hills",
                "containedInPlace": {
                    "@type": "State",
                    "name": "Michigan"
                }
            }
        ],
        "openingHours": [
            "Mo-Fr 09:00-18:00",
            "Sa 09:00-15:00"
        ],
        "priceRange": "$70-$330",
        "currenciesAccepted": "USD",
        "paymentAccepted": "Cash, Credit Card, Debit Card, Online Payment",
        "hasOfferCatalog": {
            "@type": "OfferCatalog",
            "name": "Massage Therapy Services",
            "itemListElement": [
                {
                    "@type": "Offer",
                    "itemOffered": {
                        "@type": "Service",
                        "name": "Mindful Start Massage",
                        "description": "Personalized bodywork session combining massage techniques tailored to your specific needs.",
                        "category": "Massage Therapy"
                    },
                    "price": "70.00",
                    "priceCurrency": "USD"
                },
                {
                    "@type": "Offer",
                    "itemOffered": {
                        "@type": "Service",
                        "name": "Integrated Massage",
                        "description": "Comprehensive bodywork addressing multiple concerns with various modalities.",
                        "category": "Massage Therapy"
                    },
                    "price": "100.00",
                    "priceCurrency": "USD"
                },
                {
                    "@type": "Offer",
                    "itemOffered": {
                        "@type": "Service",
                        "name": "Thai-Stretch Fusion",
                        "description": "Dynamic stretching combined with massage for improved mobility and flexibility.",
                        "category": "Bodywork"
                    },
                    "price": "120.00",
                    "priceCurrency": "USD"
                },
                {
                    "@type": "Offer",
                    "itemOffered": {
                        "@type": "Service",
                        "name": "Applied Neurology Consultation",
                        "description": "Specialized assessment and treatment using neurology-based techniques.",
                        "category": "Consultation"
                    },
                    "price": "150.00",
                    "priceCurrency": "USD"
                },
                {
                    "@type": "Offer",
                    "itemOffered": {
                        "@type": "Service",
                        "name": "Prenatal Massage",
                        "description": "Safe, gentle massage therapy specifically designed for expecting mothers.",
                        "category": "Specialty Massage"
                    },
                    "price": "90.00",
                    "priceCurrency": "USD"
                }
            ]
        },
        "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.9",
            "reviewCount": "47",
            "bestRating": "5",
            "worstRating": "1"
        },
        "review": [
            {
                "@type": "Review",
                "author": {
                    "@type": "Person",
                    "name": "Sarah M."
                },
                "reviewRating": {
                    "@type": "Rating",
                    "ratingValue": "5",
                    "bestRating": "5"
                },
                "reviewBody": "Christopher's expertise in applied neurology changed my life. After months of chronic pain, I finally found relief through his specialized techniques."
            },
            {
                "@type": "Review",
                "author": {
                    "@type": "Person",
                    "name": "Jennifer K."
                },
                "reviewRating": {
                    "@type": "Rating",
                    "ratingValue": "5",
                    "bestRating": "5"
                },
                "reviewBody": "The prenatal massage sessions helped me through my entire pregnancy. Christopher is incredibly knowledgeable and made me feel completely comfortable."
            },
            {
                "@type": "Review",
                "author": {
                    "@type": "Person",
                    "name": "Mike R."
                },
                "reviewRating": {
                    "@type": "Rating",
                    "ratingValue": "5",
                    "bestRating": "5"
                },
                "reviewBody": "The online booking system is so convenient, and the results speak for themselves. Best therapeutic massage I've ever had."
            }
        ],
        "makesOffer": [
            {
                "@type": "Offer",
                "name": "Online Appointment Booking",
                "description": "Convenient online booking system available 24/7"
            },
            {
                "@type": "Offer",
                "name": "Membership Programs",
                "description": "Flexible membership programs with discounted rates and priority booking"
            },
            {
                "@type": "Offer",
                "name": "Gift Certificates",
                "description": "Digital gift certificates available for purchase online"
            }
        ],
        "founder": {
            "@type": "Person",
            "name": "Christopher Rembisz",
            "jobTitle": "Licensed Massage Therapist",
            "description": "Licensed Massage Therapist specializing in pain management and applied neurology techniques.",
            "knowsAbout": [
                "Massage Therapy",
                "Applied Neurology",
                "Pain Management",
                "Therapeutic Bodywork",
                "Prenatal Massage",
                "Thai Massage",
                "Myofascial Release"
            ]
        },
        "sameAs": [
            "https://www.facebook.com/considerrestoration",
            "https://www.instagram.com/considerrestoration",
            "https://www.linkedin.com/in/christopher-rembisz"
        ],
        "image": "https://considerrestoration.com/images/hero-massage-therapy.jpg",
        "logo": "https://considerrestoration.com/images/logo.png"
    }
    </script>

    <!-- Professional Service Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "ProfessionalService",
        "name": "Consider Restoration Massage Therapy",
        "description": "Professional massage therapy services focusing on pain relief and body restoration through specialized techniques.",
        "provider": {
            "@type": "Person",
            "name": "Christopher Rembisz",
            "jobTitle": "Licensed Massage Therapist"
        },
        "areaServed": {
            "@type": "State",
            "name": "Michigan"
        },
        "availableService": [
            {
                "@type": "MedicalTherapy",
                "name": "Therapeutic Massage",
                "description": "Professional massage therapy for pain relief and wellness"
            },
            {
                "@type": "MedicalTherapy", 
                "name": "Applied Neurology",
                "description": "Specialized neurology-based assessment and treatment"
            },
            {
                "@type": "MedicalTherapy",
                "name": "Prenatal Massage",
                "description": "Safe massage therapy for expecting mothers"
            }
        ]
    }
    </script>

    <!-- Organization Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "Consider Restoration",
        "url": "https://considerrestoration.com",
        "logo": "https://considerrestoration.com/images/logo.png",
        "contactPoint": {
            "@type": "ContactPoint",
            "telephone": "(734) 419-4116",
            "contactType": "customer service",
            "availableLanguage": "English"
        },
        "address": {
            "@type": "PostalAddress",
            "addressLocality": "Livonia",
            "addressRegion": "MI",
            "addressCountry": "US"
        }
    }
    </script>

    <!-- Website Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "Consider Restoration",
        "url": "https://considerrestoration.com",
        "potentialAction": {
            "@type": "SearchAction",
            "target": "https://considerrestoration.com/search?q={search_term_string}",
            "query-input": "required name=search_term_string"
        }
    }
    </script>
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <header>
        <nav class="navbar">
            <div class="nav-container">
                <h1 class="logo">Consider Restoration</h1>
                <ul class="nav-menu">
                    <li><a href="index.html" class="active">Home</a></li>
                    <li><a href="about.html">About</a></li>
                    <li><a href="services.html">Services</a></li>
                    <li><a href="membership.html">Membership</a></li>
                    <li><a href="booking.html">Book Appointment</a></li>
                    <li><a href="reviews.html">Reviews</a></li>
                    <li><a href="contact.html">Contact</a></li>
                    <li><a href="user-portal.html" id="accountNavLink">Login</a></li>
                    <li id="adminNavLink" style="display: none;"><a href="admin.html">Admin</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <main id="main-content">
        <section id="home" class="hero">
            <div class="hero-content">
                <h2>Because Pain Shouldn't Be Your Normal</h2>
                <p>Pain relief and body restoration through specialized massage and bodywork</p>
                <a href="booking.html" class="cta-button">Book Your Session</a>
            </div>
        </section>
        
        <section class="home-preview">
            <div class="container">
                <div class="preview-grid">
                    <div class="preview-card">
                        <h3>About Christopher</h3>
                        <p>Licensed Massage Therapist specializing in pain management and applied neurology techniques.</p>
                        <a href="about.html" class="preview-link">Learn More →</a>
                    </div>
                    <div class="preview-card">
                        <h3>Services</h3>
                        <p>From mindful bodywork to specialized neurology consultations, find the right treatment for you.</p>
                        <a href="services.html" class="preview-link">View Services →</a>
                    </div>
                    <div class="preview-card">
                        <h3>Membership</h3>
                        <p>Save money and prioritize your wellness with our flexible membership programs.</p>
                        <a href="membership.html" class="preview-link">Join Today →</a>
                    </div>
                </div>
            </div>
        </section>
        
        <section class="testimonials">
            <div class="container">
                <h2>What Our Clients Say</h2>
                <div class="testimonials-grid" id="testimonialsGrid">
                    <!-- Reviews will be populated here dynamically -->
                    <div class="testimonial-card placeholder">
                        <div class="testimonial-content">
                            <p>Loading client reviews...</p>
                        </div>
                        <div class="testimonial-author">
                            <strong>Please wait</strong>
                            <span>Loading</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2024 Consider Restoration - Christopher Rembisz, LMT. All rights reserved.</p>
        </div>
    </footer>

    <div id="paymentModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>Complete Your Payment</h3>
            <div id="card-element"></div>
            <div id="card-errors" role="alert"></div>
            <button id="submit-payment">Pay Now</button>
        </div>
    </div>

    <div id="loginPromptModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeLoginPrompt()">&times;</span>
            <h3>Login Required</h3>
            <div class="login-prompt-content">
                <p>You need to be logged in to book an appointment.</p>
                <div class="login-prompt-buttons">
                    <button class="btn-primary" onclick="goToLogin()">Login to Existing Account</button>
                    <button class="btn-secondary" onclick="goToRegister()">Create New Account</button>
                </div>
                <p class="login-note">Your booking information will be saved and restored after you login or register.</p>
            </div>
        </div>
    </div>

    <script src="js/script.js"></script>
    <script>
        // Load and display real reviews from shared data
        function loadTestimonials() {
            try {
                const testimonialsGrid = document.getElementById('testimonialsGrid');
                if (!testimonialsGrid) {
                    console.log('loadTestimonials: testimonialsGrid not found');
                    return;
                }
            
            console.log('loadTestimonials: Starting to load testimonials');
            console.log('loadTestimonials: window.getReviews available?', typeof window.getReviews);
            
            // Get reviews from shared data system
            let reviews = [];
            if (window.getReviews) {
                reviews = window.getReviews();
                console.log('loadTestimonials: Got reviews:', reviews.length);
            } else {
                console.log('loadTestimonials: window.getReviews not available, will use fallback');
            }
            
            // Default fallback reviews if no real reviews exist
            const fallbackReviews = [
                {
                    id: 'fallback1',
                    name: 'Sarah M.',
                    rating: 5,
                    review: 'Christopher\'s expertise in applied neurology changed my life. After months of chronic pain, I finally found relief through his specialized techniques.',
                    service: 'Chronic Pain Relief'
                },
                {
                    id: 'fallback2',
                    name: 'Jennifer K.',
                    rating: 5,
                    review: 'The prenatal massage sessions helped me through my entire pregnancy. Christopher is incredibly knowledgeable and made me feel completely comfortable.',
                    service: 'Prenatal Massage'
                },
                {
                    id: 'fallback3',
                    name: 'Mike R.',
                    rating: 5,
                    review: 'The online booking system is so convenient, and the results speak for themselves. Best therapeutic massage I\'ve ever had.',
                    service: 'Sports Recovery'
                }
            ];
            
            // Use real reviews if available, otherwise use fallback
            const reviewsToShow = reviews.length > 0 ? reviews : fallbackReviews;
            
            // Option A: Quality-First Approach - Best reviews regardless of date
            const topReviews = reviewsToShow
                .filter(review => review.rating >= 4) // Only 4+ star reviews
                .sort((a, b) => {
                    // First priority: Rating (5 stars first, then 4 stars)
                    if (b.rating !== a.rating) {
                        return b.rating - a.rating;
                    }
                    // Second priority: Content length (more detailed reviews first)
                    const aReviewLength = (a.review || '').length;
                    const bReviewLength = (b.review || '').length;
                    const lengthDiff = bReviewLength - aReviewLength;
                    if (Math.abs(lengthDiff) > 50) { // Significant difference in detail
                        return lengthDiff;
                    }
                    // Third priority: Has specific service mentioned
                    const aHasService = a.service && a.service !== 'Massage Therapy';
                    const bHasService = b.service && b.service !== 'Massage Therapy';
                    if (aHasService !== bHasService) {
                        return bHasService ? 1 : -1;
                    }
                    // Final tiebreaker: Most recent
                    const dateA = new Date(a.createdAt || '2024-01-01');
                    const dateB = new Date(b.createdAt || '2024-01-01');
                    return dateB - dateA;
                })
                .slice(0, 3);
            
            // Generate testimonial HTML
            const testimonialsHTML = topReviews.map(review => {
                const stars = '⭐'.repeat(review.rating);
                const displayName = review.name || 'Anonymous';
                const serviceType = review.service || 'Massage Therapy';
                
                return `
                    <div class="testimonial-card">
                        <div class="testimonial-content">
                            <p>"${review.review}"</p>
                        </div>
                        <div class="testimonial-author">
                            <strong>${displayName}</strong>
                            <span>${serviceType}</span>
                        </div>
                        <div class="testimonial-rating">${stars}</div>
                    </div>
                `;
            }).join('');
            
            testimonialsGrid.innerHTML = testimonialsHTML;
            } catch (error) {
                console.error('Error in loadTestimonials:', error);
                // Provide fallback content if testimonials fail to load
                const testimonialsGrid = document.getElementById('testimonialsGrid');
                if (testimonialsGrid) {
                    testimonialsGrid.innerHTML = '<p>Testimonials temporarily unavailable.</p>';
                }
            }
        }
        
        // Check for user authentication and update navigation
        document.addEventListener('DOMContentLoaded', function() {
            // Load testimonials with improved retry mechanism
            function tryLoadTestimonials(attempt = 1) {
                console.log('Attempt', attempt, 'to load testimonials');
                try {
                    if (window.getReviews && typeof window.getReviews === 'function') {
                        console.log('shared-data.js loaded, loading testimonials now');
                        loadTestimonials();
                        return; // Exit the retry loop successfully
                    } else if (attempt < 5) { // Reduced from 10 to 5 attempts
                        console.log('shared-data.js not ready, retrying in 200ms');
                        setTimeout(() => tryLoadTestimonials(attempt + 1), 200); // Increased delay
                    } else {
                        console.log('shared-data.js still not ready after 5 attempts, skipping testimonials');
                        // Skip fallback to prevent potential issues
                    }
                } catch (error) {
                    console.error('Error in tryLoadTestimonials:', error);
                }
            }
            
            tryLoadTestimonials();
            
            // Listen for new reviews and refresh testimonials
            window.addEventListener('reviewAdded', function() {
                setTimeout(loadTestimonials, 100); // Small delay to ensure data is updated
            });
            
            const adminNavLink = document.getElementById('adminNavLink');
            const accountNavLink = document.getElementById('accountNavLink');
            
            function updateNavigation() {
                const currentUser = localStorage.getItem('currentUser');
                
                if (currentUser) {
                    try {
                        const user = JSON.parse(currentUser);
                        if (user.role === 'admin') {
                            adminNavLink.style.display = 'block';
                            accountNavLink.textContent = 'My Account';
                        } else if (user.role === 'user') {
                            adminNavLink.style.display = 'none';
                            accountNavLink.textContent = 'My Account';
                        }
                    } catch (e) {
                        // Invalid stored data, ignore
                        adminNavLink.style.display = 'none';
                        accountNavLink.textContent = 'Login';
                    }
                } else {
                    // No user logged in
                    adminNavLink.style.display = 'none';
                    accountNavLink.textContent = 'Login';
                }
            }
            
            // Initial check
            updateNavigation();
            
            // Listen for storage changes (when user logs in/out from other pages)
            window.addEventListener('storage', function(e) {
                if (e.key === 'currentUser') {
                    updateNavigation();
                }
            });
            
            // Also listen for custom events from login/logout actions
            window.addEventListener('userAuthChanged', function() {
                updateNavigation();
            });
        });
    </script>
</body>
</html>